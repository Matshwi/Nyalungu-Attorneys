<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>POS Dash | Responsive Bootstrap 4 Admin Dashboard Template</title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="../assets/images/favicon.ico" />
    <link rel="stylesheet" href="../assets/css/backend-plugin.min.css" />
    <link rel="stylesheet" href="../assets/css/backend.css?v=1.0.0" />
    <link
      rel="stylesheet"
      href="../assets/vendor/@fortawesome/fontawesome-free/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="../assets/vendor/line-awesome/dist/line-awesome/css/line-awesome.min.css"
    />
    <link
      rel="stylesheet"
      href="../assets/vendor/remixicon/fonts/remixicon.css"
    />
  </head>
  <body class=" ">
    <!-- loader Start -->
    <div id="loading">
      <div id="loading-center"></div>
    </div>
    <!-- loader END -->

    <div class="wrapper">
      <section class="login-content">
        <div class="container">
          <div
            class="row align-items-center justify-content-center height-self-center"
          >
            <div class="col-lg-8">
              <div class="card auth-card">
                <div class="card-body p-0">
                  <div class="d-flex align-items-center auth-content">
                    <div class="col-lg-7 align-self-center">
                      <div class="p-3">
                        <img
                          src="../assets/images/login/mail.png"
                          class="img-fluid"
                          width="80"
                          alt=""
                        />
                        <h2 class="mt-3 mb-0" id="tasksubject"></h2>
                        <p class="cnf-mail mb-1" id="taskdesc"></p>
                        <div class="d-inline-block w-100">
                          <a
                            id="completedtask"
                            class="btn btn-primary mt-3"
                            >Close</a
                          >
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-5 content-right">
                      <img
                        src="../assets/images/login/01.png"
                        class="img-fluid image-right"
                        alt=""
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Backend Bundle JavaScript -->
    <script src="../assets/js/backend-bundle.min.js"></script>

    <!-- Table Treeview JavaScript -->
    <script src="../assets/js/table-treeview.js"></script>

    <!-- Chart Custom JavaScript -->
    <script src="../assets/js/customizer.js"></script>

    <!-- Chart Custom JavaScript -->
    <script async src="../assets/js/chart-custom.js"></script>

    <!-- app JavaScript -->
    <script src="../assets/js/app.js"></script><script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"; 

  //https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js
  //https://www.gstatic.com/firebasejs/11.9.1/firebase-analytics.js
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
 import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, signInWithEmailAndPassword, onAuthStateChanged, updatePassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
  import { getDatabase, ref, push, onValue, update } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries
//import { database } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  //import { firebase } from 'https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js';

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyCwMAE5I9frXiRjGTLB7kZOS1yYaBSmf_M",
    authDomain: "omsl-61c79.firebaseapp.com",
    projectId: "omsl-61c79",
    storageBucket: "omsl-61c79.firebasestorage.app",
    messagingSenderId: "406069597322",
    appId: "1:406069597322:web:6ab82f14010e6f3f004973",
    measurementId: "G-4CJ3M03JE1"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  //console.log(defaultProject.name);
  const analytics = getAnalytics(app);
//import { getDatabase } from "fhttps://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  // Get a reference to the database service
var database = getDatabase(app);
const auth = getAuth(app);
// Reference to the root of your database

const urlParams = new URLSearchParams(document.location.search);
var paramValue = urlParams.get('id');
var taskid = urlParams.get('taskid');

var rootRef = ref(database, 'users/' + paramValue);

var notificationRef = ref(database, 'Notification/' + taskid);



onAuthStateChanged(auth, (user) => {
      if (user) {


} else {
        // User is signed out
        console.log("User is signed out.");
        window.location.href = `auth-sign-in.html`;
      }
    });







// Fetch data from the 'task' node once
onValue(notificationRef, (snapshot) => {

  
      const taskKey = snapshot.key;
      const taskdata = snapshot.val();


   
   //const taskdata = snapshot.val();
console.log(taskdata+"this is task");
document.getElementById("tasksubject").innerHTML =`${taskdata.title} from ${taskdata.from}`;
document.getElementById("taskdesc").innerHTML =`${taskdata.desc}`;



    
  
    onlyOnce: true // This option ensures the callback is executed only once
  });

var taskcomplete = document.getElementById("completedtask");

taskcomplete.onclick = function(){

  const updates = {
      status: "read"
    };

    update(notificationRef, updates)
  .then(() => {
    console.log("User data updated successfully.");
    window.location.href = `index.html?id=${paramValue}`;
  })
  .catch((error) => {
    console.error("Error updating user data:", error);
  });




  }


</script>


  </body>
</html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      